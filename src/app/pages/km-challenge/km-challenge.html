<div class="challenge-container">
  <div class="content-wrapper">
    <div class="header">
      <h1>{{ kmChallengeService.config.title }}</h1>
      <app-goal-banner
        [total]="total"
        [goals]="kmChallengeService.config.goals"
        [unit]="kmChallengeService.config.metricUnit">
      </app-goal-banner>
    </div>

    <app-challenge-form
      [config]="kmChallengeService.config"
      (submitted)="onSubmit($event)"
      (valueChanged)="onValueChange($event)">
    </app-challenge-form>

    <div class="data-section">
      <app-stats-table
        [entries]="entries"
        [unit]="kmChallengeService.config.metricUnit"
        (deleteRequested)="onDelete($event)">
      </app-stats-table>
      <app-ranking-table
        [rankings]="rankings"
        [unit]="kmChallengeService.config.metricUnit">
      </app-ranking-table>
    </div>

    <div class="progress-section">
      <div class="progress-header">
        <h2>ðŸ“ˆ Fortschritt Gesamt: {{total}} {{kmChallengeService.config.metricUnit}}</h2>
        <div class="progress-bar">
          <div class="progress" [style.width.%]="progressPercentage">
            {{progressPercentage}}%
          </div>
        </div>
      </div>
      <app-progress-chart
        [total]="total"
        [config]="kmChallengeService.config">
      </app-progress-chart>
    </div>
  </div>

  @if (lockService.showLockScreen$ | async) {
    <app-lock-screen
      (success)="lockService.handleUnlockSuccess()"
      (cancel)="lockService.handleUnlockCancel()">
    </app-lock-screen>
  }
</div>
