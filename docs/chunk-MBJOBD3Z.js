import{d as j}from"./chunk-VHLRGLRA.js";import{a as R,b as U,c as L,d as $}from"./chunk-LI6XCKNP.js";import{$a as m,$b as I,Da as C,Kb as x,Lb as E,Ra as v,Sa as b,Sb as D,Tb as T,Wa as c,Xa as a,Y as u,Ya as r,Z as f,Za as p,_a as S,ab as _,ac as V,d,eb as P,gb as h,hb as O,ib as M,jb as k,ob as y,pb as w,ta as i,xa as g}from"./chunk-GZDO7HLK.js";function B(s,n){if(s&1){let t=S();a(0,"app-lock-screen",13),m("success",function(){u(t);let o=_();return f(o.lockService.handleUnlockSuccess())})("cancel",function(){u(t);let o=_();return f(o.lockService.handleUnlockCancel())}),r()}}var q=class s{constructor(n,t,e){this.challengeService=n;this.lockService=t;this.toast=e}entries=[];rankings=[];total=0;progressPercentage=0;subscriptions=[];ngOnInit(){this.subscriptions.push(this.challengeService.entries$.subscribe(n=>{this.entries=[...n].sort((t,e)=>new Date(e.date).getTime()-new Date(t.date).getTime())}),this.challengeService.rankings$.subscribe(n=>{this.rankings=n}),this.challengeService.total$.subscribe(n=>{this.total=n,this.progressPercentage=Math.min(Math.round(n/this.challengeService.config.goalValue*100),100)}))}ngOnDestroy(){this.subscriptions.forEach(n=>n.unsubscribe())}onValueChange(n){let{name:t,value:e}=n;e>this.challengeService.config.maxEntryValue?this.toast.show("Sei ehrlich \u{1F925}\u{1F60F}\u{1F633}"):e>350?this.toast.show("Boaah \u{1F628}"):e>100&&this.toast.show(`Stark ${t.split(" ")[0]} \u{1F4AA}`)}onSubmit(n){return d(this,null,function*(){try{yield this.challengeService.submitData(n.name,n.value)}catch(t){console.error("Error submitting data:",t)}})}onDelete(n){return d(this,null,function*(){try{yield this.challengeService.deleteData(n)}catch(t){console.error("Error deleting entry:",t)}})}static \u0275fac=function(t){return new(t||s)(g(j),g(I),g(V))};static \u0275cmp=C({type:s,selectors:[["app-challenge"]],decls:20,vars:19,consts:[[1,"challenge-container"],[1,"content-wrapper"],[1,"header"],[3,"total","goals","unit"],[3,"submitted","valueChanged","config"],[1,"data-section"],[3,"deleteRequested","entries","unit"],[3,"rankings","unit"],[1,"progress-section"],[1,"progress-header"],[1,"progress-bar"],[1,"progress"],[3,"total","config"],[3,"success","cancel"]],template:function(t,e){t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),h(4),r(),p(5,"app-goal-banner",3),r(),a(6,"app-challenge-form",4),m("submitted",function(l){return e.onSubmit(l)})("valueChanged",function(l){return e.onValueChange(l)}),r(),a(7,"div",5)(8,"app-stats-table",6),m("deleteRequested",function(l){return e.onDelete(l)}),r(),p(9,"app-ranking-table",7),r(),a(10,"div",8)(11,"div",9)(12,"h2"),h(13),r(),a(14,"div",10)(15,"div",11),h(16),r()()(),p(17,"app-progress-chart",12),r()(),v(18,B,1,0,"app-lock-screen"),y(19,"async"),r()),t&2&&(i(4),O(e.challengeService.config.title),i(),c("total",e.total)("goals",e.challengeService.config.goals)("unit",e.challengeService.config.metricUnit),i(),c("config",e.challengeService.config),i(2),c("entries",e.entries)("unit",e.challengeService.config.metricUnit),i(),c("rankings",e.rankings)("unit",e.challengeService.config.metricUnit),i(4),k("\u{1F4C8} Fortschritt Gesamt: ",e.total," ",e.challengeService.config.metricUnit),i(2),P("width",e.progressPercentage,"%"),i(),M(" ",e.progressPercentage,"% "),i(),c("total",e.total)("config",e.challengeService.config),i(),b(w(19,17,e.lockService.showLockScreen$)?18:-1))},dependencies:[E,x,R,D,U,T,L,$],styles:[".challenge-container[_ngcontent-%COMP%]{min-height:100vh;width:100%;background:url(https://raw.githubusercontent.com/SANTOC01/gipfelstuermer-tracker/refs/heads/main/assets/mountain.jpg);background-size:cover;background-position:top;background-repeat:no-repeat;overflow-y:auto;padding-top:80px}.challenge-container[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{min-height:calc(100vh - 80px);max-width:1200px;margin:0 auto;padding:2rem;position:relative;z-index:1}.challenge-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.challenge-container[_ngcontent-%COMP%]   .data-section[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:2rem;margin-bottom:2rem;padding:1rem;max-width:900px;margin-left:auto;margin-right:auto;background:#ffffffe6;border-radius:15px;box-shadow:0 4px 6px #0000001a}.challenge-container[_ngcontent-%COMP%]   .data-section[_ngcontent-%COMP%]   app-stats-table[_ngcontent-%COMP%], .challenge-container[_ngcontent-%COMP%]   .data-section[_ngcontent-%COMP%]   app-ranking-table[_ngcontent-%COMP%]{flex:1;min-width:0}.challenge-container[_ngcontent-%COMP%]   .progress-section[_ngcontent-%COMP%]{max-width:900px;margin-left:auto;margin-right:auto;margin-bottom:2rem;padding:1.5rem;background:#fff;border-radius:15px;box-shadow:0 4px 6px #0000001a}.challenge-container[_ngcontent-%COMP%]   .progress-section[_ngcontent-%COMP%]   .progress-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.challenge-container[_ngcontent-%COMP%]   .progress-section[_ngcontent-%COMP%]   .progress-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:1rem}.challenge-container[_ngcontent-%COMP%]   .progress-section[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:20px;background:#e0e0e0;border-radius:10px;overflow:hidden}.challenge-container[_ngcontent-%COMP%]   .progress-section[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{height:100%;background:#43c6ac;transition:width .3s ease;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}@media (max-width: 768px){.challenge-container[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.challenge-container[_ngcontent-%COMP%]   .data-section[_ngcontent-%COMP%]{flex-direction:column}}"]})};export{q as Challenge};
