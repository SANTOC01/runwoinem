import{$a as p,$b as z,Ca as v,Fa as y,Ha as u,Kb as B,Mb as x,Pa as R,Qa as _,Ra as M,Ta as F,Ua as A,Va as h,Wa as r,X as g,Xa as a,Y as f,Ya as V,Za as C,Zb as H,_a as d,_b as q,ab as E,ac as W,bb as w,bc as j,cb as O,cc as Q,eb as I,fb as c,gb as P,gc as U,ib as N,jb as k,kb as T,lb as S,mb as L,sa as l,wa as D}from"./chunk-XPV6J6NS.js";var J=(s,t)=>t.date+t.name;function K(s,t){if(s&1){let e=C();r(0,"button",2),d("click",function(){g(e);let i=p().$implicit,o=p();return f(o.deleteEntry(i))}),c(1,"\u274C"),a()}}function tt(s,t){if(s&1&&(r(0,"tr")(1,"td"),c(2),a(),r(3,"td"),c(4),a(),r(5,"td"),c(6),a(),r(7,"td"),_(8,K,2,0,"button",1),a()()),s&2){let e=t.$implicit,n=t.$index,i=p();l(2),P(e.name),l(2),N("",e.value," ",i.unit),l(2),P(i.formatDate(e.date)),l(2),M(n===0?8:-1)}}var Y=class s{entries=[];unit="";deleteRequested=new u;formatDate(t){return new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"2-digit"})}deleteEntry(t){this.deleteRequested.emit(t)}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=v({type:s,selectors:[["app-stats-table"]],inputs:{entries:"entries",unit:"unit"},outputs:{deleteRequested:"deleteRequested"},decls:15,vars:1,consts:[[1,"table-container"],[1,"delete-btn"],[1,"delete-btn",3,"click"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"h2"),c(2,"\u{1F4CB} Letzte Eintr\xE4ge"),a(),r(3,"table")(4,"tr")(5,"th"),c(6,"Name"),a(),r(7,"th"),c(8),a(),r(9,"th"),c(10,"Datum"),a(),r(11,"th"),c(12,"L\xF6schen"),a()(),F(13,tt,9,5,"tr",null,J),a()()),e&2&&(l(8),P(n.unit),l(5),A(n.entries))},dependencies:[x],styles:[".table-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 10px;text-align:center;color:#2c3e50}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;table-layout:fixed;font-size:12px;border-collapse:collapse}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px;text-align:center;word-wrap:normal;overflow:hidden;white-space:normal}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#2c3e50;font-weight:700}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f8f9fa}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.table-container[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:4px 8px;border-radius:4px}.table-container[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover{background-color:#ffe6e6}@media (max-width: 768px){.table-container[_ngcontent-%COMP%]{max-width:100%}}"]})};var et=["gridContainer"],nt=["patternCanvas"],it=()=>[0,1,2],ot=()=>[1,2,3];function at(s,t){if(s&1){let e=C();r(0,"button",9),d("mousedown",function(i){g(e);let o=p(2);return f(o.handleMouseDown(i))})("touchstart",function(i){g(e);let o=p(2);return f(o.handleTouchStart(i))}),a()}if(s&2){let e=t.$implicit,n=p().$implicit;R("data-value",n*3+e)}}function rt(s,t){s&1&&(r(0,"div",7),y(1,at,1,1,"button",8),a()),s&2&&(l(),h("ngForOf",L(1,ot)))}var Z=class s{constructor(t){this.toastService=t}success=new u;cancel=new u;gridContainer;canvasRef;CORRECT_PATTERN="1-4-7-8-9";inputPattern=[];isMouseDown=!1;isTouchActive=!1;lastPoint=null;buttonPositions={};boundMouseMove;boundMouseUp;boundTouchMove;boundTouchEnd;ngAfterViewInit(){this.setupCanvas(),this.setupEventListeners(),this.disableScrolling()}setupCanvas(){let t=this.canvasRef.nativeElement;t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.pointerEvents="none",t.style.zIndex="1",this.updateCanvasSize(),this.storeButtonPositions()}setupEventListeners(){this.boundMouseMove=this.handleMouseMove.bind(this),this.boundMouseUp=this.handleMouseUp.bind(this),this.boundTouchMove=this.handleTouchMove.bind(this),this.boundTouchEnd=this.handleTouchEnd.bind(this),document.addEventListener("mousemove",this.boundMouseMove),document.addEventListener("mouseup",this.boundMouseUp),document.addEventListener("touchmove",this.boundTouchMove,{passive:!1}),document.addEventListener("touchend",this.boundTouchEnd)}disableScrolling(){document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%"}handleMouseDown(t){this.resetPattern(),this.isMouseDown=!0;let e=t.target;this.addPointToPattern(e)}handleMouseMove(t){if(!this.isMouseDown)return;let n=this.gridContainer.nativeElement.getBoundingClientRect(),i=t.clientX-n.left,o=t.clientY-n.top;this.checkIntersection(i,o),this.drawLines(i,o)}handleMouseUp(){this.isMouseDown&&(this.isMouseDown=!1,this.checkPattern(),this.resetActiveButtons(),this.clearCanvas())}handleTouchStart(t){t.preventDefault(),this.resetPattern(),this.isTouchActive=!0;let e=t.touches[0],n=document.elementFromPoint(e.clientX,e.clientY);this.addPointToPattern(n)}handleTouchMove(t){if(t.preventDefault(),!this.isTouchActive)return;let e=t.touches[0],i=this.gridContainer.nativeElement.getBoundingClientRect(),o=e.clientX-i.left,m=e.clientY-i.top;this.checkIntersection(o,m),this.drawLines(o,m)}handleTouchEnd(){this.isTouchActive&&(this.isTouchActive=!1,this.checkPattern(),this.resetActiveButtons(),this.clearCanvas())}resetPattern(){this.inputPattern=[],this.lastPoint=null,this.resetActiveButtons(),this.clearCanvas()}resetActiveButtons(){this.gridContainer.nativeElement.querySelectorAll(".grid-button").forEach(e=>e.classList.remove("active"))}clearCanvas(){let t=this.canvasRef.nativeElement,e=t.getContext("2d");e&&e.clearRect(0,0,t.width,t.height)}addPointToPattern(t){let e=t?.getAttribute("data-value");e&&!this.inputPattern.includes(e)&&(this.inputPattern.push(e),t.classList.add("active"),this.lastPoint=this.buttonPositions[e],this.drawLines())}checkPattern(){this.inputPattern.join("-")===this.CORRECT_PATTERN?this.success.emit():this.inputPattern.length>0&&this.toastService.show("Muster falsch, versuche es erneut.")}onCancel(){this.cancel.emit()}ngOnDestroy(){document.removeEventListener("mousemove",this.boundMouseMove),document.removeEventListener("mouseup",this.boundMouseUp),document.removeEventListener("touchmove",this.boundTouchMove),document.removeEventListener("touchend",this.boundTouchEnd),document.body.style.overflow="",document.body.style.position="",document.body.style.width=""}updateCanvasSize(){let t=this.canvasRef.nativeElement,e=this.gridContainer.nativeElement;t.width=e.offsetWidth,t.height=e.offsetHeight}storeButtonPositions(){this.gridContainer.nativeElement.querySelectorAll(".grid-button").forEach(e=>{let n=e.getBoundingClientRect(),i=this.gridContainer.nativeElement.getBoundingClientRect(),o=e.getAttribute("data-value");o&&(this.buttonPositions[o]={x:n.left+n.width/2-i.left,y:n.top+n.height/2-i.top})})}checkIntersection(t,e){Object.entries(this.buttonPositions).forEach(([n,i])=>{if(Math.sqrt(Math.pow(t-i.x,2)+Math.pow(e-i.y,2))<20&&!this.inputPattern.includes(n)){let m=this.gridContainer.nativeElement.querySelector(`[data-value="${n}"]`);m&&(this.inputPattern.push(n),m.classList.add("active"),this.lastPoint=i,this.drawLines())}})}drawLines(t,e){let n=this.canvasRef.nativeElement,i=n.getContext("2d");if(!i)return;i.clearRect(0,0,n.width,n.height),i.strokeStyle="#43c6ac",i.lineWidth=2,i.beginPath();let o=null;for(let m of this.inputPattern){let b=this.buttonPositions[m];o?i.lineTo(b.x,b.y):i.moveTo(b.x,b.y),o=b}o&&t!==void 0&&e!==void 0&&i.lineTo(t,e),i.stroke()}static \u0275fac=function(e){return new(e||s)(D(U))};static \u0275cmp=v({type:s,selectors:[["app-lock-screen"]],viewQuery:function(e,n){if(e&1&&(E(et,5),E(nt,5)),e&2){let i;w(i=O())&&(n.gridContainer=i.first),w(i=O())&&(n.canvasRef=i.first)}},outputs:{success:"success",cancel:"cancel"},decls:13,vars:2,consts:[["gridContainer",""],["patternCanvas",""],[1,"unlock-popup"],[1,"unlock-content"],[1,"grid-container"],["class","grid-row",4,"ngFor","ngForOf"],[1,"unlock-cancel",3,"click"],[1,"grid-row"],["class","grid-button",3,"mousedown","touchstart",4,"ngFor","ngForOf"],[1,"grid-button",3,"mousedown","touchstart"]],template:function(e,n){if(e&1){let i=C();r(0,"div",2)(1,"div",3)(2,"h2"),c(3,"Entsperren"),a(),r(4,"p"),c(5,"Zeichne das Muster zum Entsperren"),a(),r(6,"div",4,0),V(8,"canvas",null,1),y(10,rt,2,2,"div",5),a(),r(11,"button",6),d("click",function(){return g(i),f(n.onCancel())}),c(12,"Abbrechen"),a()()()}e&2&&(l(10),h("ngForOf",L(1,it)))},dependencies:[x,B],styles:["[_nghost-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000;background:#00000080;display:flex;align-items:center;justify-content:center}.unlock-popup[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000c;z-index:1000;display:flex;justify-content:center;align-items:center}.unlock-popup[_ngcontent-%COMP%]   .unlock-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:10px;text-align:center;max-width:90%;width:300px}.unlock-popup[_ngcontent-%COMP%]   .unlock-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 10px}.unlock-popup[_ngcontent-%COMP%]   .unlock-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px;color:#666}.unlock-popup[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]{position:relative;margin:20px auto;width:240px;height:240px}.unlock-popup[_ngcontent-%COMP%]   .grid-row[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin:20px 0}.unlock-popup[_ngcontent-%COMP%]   .grid-button[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;border:2px solid #ccc;background:#fff;transition:all .2s}.unlock-popup[_ngcontent-%COMP%]   .grid-button.active[_ngcontent-%COMP%]{background:#43c6ac;border-color:#43c6ac}.unlock-popup[_ngcontent-%COMP%]   .unlock-cancel[_ngcontent-%COMP%]{margin-top:20px;padding:10px 20px;border:none;border-radius:5px;background:#f44336;color:#fff;cursor:pointer}.unlock-popup[_ngcontent-%COMP%]   .unlock-cancel[_ngcontent-%COMP%]:hover{background:#d32f2f}.pattern-canvas[_ngcontent-%COMP%]{pointer-events:none}.toast[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:50%;transform:translate(-50%) translateY(100px);background:#000c;color:#fff;padding:12px 24px;border-radius:4px;opacity:0;transition:all .3s ease}.toast.show[_ngcontent-%COMP%]{transform:translate(-50%) translateY(0);opacity:1}"]})};function st(s,t){s&1&&(r(0,"p",4),c(1,"\u{1F512} Challenge beendet \u2013 danke f\xFCr eure Teilnahme!"),a())}var G=class s{config;submitted=new u;valueChanged=new u;name="";value=null;onSubmit(){this.name&&this.value!=null&&this.submitted.emit({name:this.name,value:this.value})}onValueChange(){this.name&&this.value!=null&&this.valueChanged.emit({name:this.name,value:this.value})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=v({type:s,selectors:[["app-challenge-form"]],inputs:{config:"config"},outputs:{submitted:"submitted",valueChanged:"valueChanged"},decls:6,vars:10,consts:[[1,"input-section"],["type","text","placeholder","Dein Name",3,"ngModelChange","ngModel","disabled"],["type","number",3,"ngModelChange","input","ngModel","placeholder","max","disabled"],[3,"click","disabled"],[1,"challenge-status"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"input",1),S("ngModelChange",function(o){return T(n.name,o)||(n.name=o),o}),a(),r(2,"input",2),S("ngModelChange",function(o){return T(n.value,o)||(n.value=o),o}),d("input",function(){return n.onValueChange()}),a(),r(3,"button",3),d("click",function(){return n.onSubmit()}),c(4," Absenden "),a(),_(5,st,2,0,"p",4),a()),e&2&&(l(),k("ngModel",n.name),h("disabled",!n.config.active),l(),k("ngModel",n.value),h("placeholder",n.config.metricLabel)("max",n.config.maxEntryValue)("disabled",!n.config.active),l(),I("disabled",!n.config.active),h("disabled",!n.config.active),l(2),M(n.config.active?-1:5))},dependencies:[Q,H,W,q,j,z],styles:[".input-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;margin-bottom:2rem;width:100%;max-width:170px;margin-left:auto;margin-right:auto}.input-section[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:.8rem;border:none;border-radius:8px;box-shadow:0 2px 4px #0000001a}.input-section[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{background:#e8e8e8;color:#888;cursor:not-allowed}.input-section[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}.input-section[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, .input-section[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.input-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#43c6ac;color:#fff;cursor:pointer;transition:background .3s ease}.input-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background:#3ab19c}.input-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled, .input-section[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{background:#b0b0b0;color:#f0f0f0;cursor:not-allowed;opacity:.7}.input-section[_ngcontent-%COMP%]   .challenge-status[_ngcontent-%COMP%]{margin:0;font-size:.8rem;color:#555;text-align:center;background:#ffffffbf;border-radius:6px;padding:.4rem .6rem;width:100%}@media (max-width: 768px){.input-section[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{max-width:300px}}"]})};export{Y as a,Z as b,G as c};
