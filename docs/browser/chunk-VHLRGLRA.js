import{$ as we,$b as xe,A as me,Aa as ke,D as ge,I as L,Ja as Ae,K as ye,Mb as Oe,N as P,Nb as Me,O as I,Oa as Ne,Pa as Ie,Pb as re,R as E,S as v,T as m,U as ve,W as Te,X as Ee,_b as _e,a as x,aa as be,ac as je,b as ue,c as fe,d as T,g as te,ga as Re,k as j,n as $,oa as Pe,qa as De,r as S,s as X,y as pe}from"./chunk-GZDO7HLK.js";var Se={production:!0,gipfelstuermerSheetUrl:"https://script.google.com/macros/s/AKfycbyEsiUImD-pqWYWYQlyDov7s7g1q-iKTHXKk8qqE8lyhdPX_nJsQPGeWrF1wpDtDd6c/exec"};var F=class{},U=class{},w=class r{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(t){t?typeof t=="string"?this.lazyInit=()=>{this.headers=new Map,t.split(`
`).forEach(e=>{let n=e.indexOf(":");if(n>0){let s=e.slice(0,n),i=e.slice(n+1).trim();this.addHeaderEntry(s,i)}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,n)=>{this.addHeaderEntry(n,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,n])=>{this.setHeaderEntries(e,n)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();let e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){let e=new r;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){let e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(t.name,e);let s=(t.op==="a"?this.headers.get(e):void 0)||[];s.push(...n),this.headers.set(e,s);break;case"d":let i=t.value;if(!i)this.headers.delete(e),this.normalizedNames.delete(e);else{let o=this.headers.get(e);if(!o)return;o=o.filter(c=>i.indexOf(c)===-1),o.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}break}}addHeaderEntry(t,e){let n=t.toLowerCase();this.maybeSetNormalizedName(t,n),this.headers.has(n)?this.headers.get(n).push(e):this.headers.set(n,[e])}setHeaderEntries(t,e){let n=(Array.isArray(e)?e:[e]).map(i=>i.toString()),s=t.toLowerCase();this.headers.set(s,n),this.maybeSetNormalizedName(t,s)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}};var W=class{encodeKey(t){return Le(t)}encodeValue(t){return Le(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}};function Ze(r,t){let e=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(s=>{let i=s.indexOf("="),[o,c]=i==-1?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,i)),t.decodeValue(s.slice(i+1))],a=e.get(o)||[];a.push(c),e.set(o,a)}),e}var He=/%(\d[a-f0-9])/gi,et={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Le(r){return encodeURIComponent(r).replace(He,(t,e)=>et[e]??t)}function q(r){return`${r}`}var k=class r{map;encoder;updates=null;cloneFrom=null;constructor(t={}){if(this.encoder=t.encoder||new W,t.fromString){if(t.fromObject)throw new P(2805,!1);this.map=Ze(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{let n=t.fromObject[e],s=Array.isArray(n)?n.map(q):[q(n)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();let e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){let e=[];return Object.keys(t).forEach(n=>{let s=t[n];Array.isArray(s)?s.forEach(i=>{e.push({param:n,value:i,op:"a"})}):e.push({param:n,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{let e=this.encoder.encodeKey(t);return this.map.get(t).map(n=>e+"="+this.encoder.encodeValue(n)).join("&")}).filter(t=>t!=="").join("&")}clone(t){let e=new r({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":let e=(t.op==="a"?this.map.get(t.param):void 0)||[];e.push(q(t.value)),this.map.set(t.param,e);break;case"d":if(t.value!==void 0){let n=this.map.get(t.param)||[],s=n.indexOf(q(t.value));s!==-1&&n.splice(s,1),n.length>0?this.map.set(t.param,n):this.map.delete(t.param)}else{this.map.delete(t.param);break}}}),this.cloneFrom=this.updates=null)}};var Y=class{map=new Map;set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}};function tt(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Ce(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function Fe(r){return typeof Blob<"u"&&r instanceof Blob}function Ue(r){return typeof FormData<"u"&&r instanceof FormData}function rt(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var J="Content-Type",Q="Accept",ae="X-Request-URL",ze="text/plain",$e="application/json",Xe=`${$e}, ${ze}, */*`,C=class r{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;keepalive=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(t,e,n,s){this.url=e,this.method=t.toUpperCase();let i;if(tt(this.method)||s?(this.body=n!==void 0?n:null,i=s):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,this.keepalive=!!i.keepalive,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params),this.transferCache=i.transferCache),this.headers??=new w,this.context??=new Y,!this.params)this.params=new k,this.urlWithParams=e;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=e;else{let c=e.indexOf("?"),a=c===-1?"?":c<e.length-1?"&":"";this.urlWithParams=e+a+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Ce(this.body)||Fe(this.body)||Ue(this.body)||rt(this.body)?this.body:this.body instanceof k?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Ue(this.body)?null:Fe(this.body)?this.body.type||null:Ce(this.body)?null:typeof this.body=="string"?ze:this.body instanceof k?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?$e:null}clone(t={}){let e=t.method||this.method,n=t.url||this.url,s=t.responseType||this.responseType,i=t.keepalive??this.keepalive,o=t.transferCache??this.transferCache,c=t.body!==void 0?t.body:this.body,a=t.withCredentials??this.withCredentials,y=t.reportProgress??this.reportProgress,f=t.headers||this.headers,p=t.params||this.params,_=t.context??this.context;return t.setHeaders!==void 0&&(f=Object.keys(t.setHeaders).reduce((h,g)=>h.set(g,t.setHeaders[g]),f)),t.setParams&&(p=Object.keys(t.setParams).reduce((h,g)=>h.set(g,t.setParams[g]),p)),new r(e,n,c,{params:p,headers:f,context:_,reportProgress:y,responseType:s,withCredentials:a,transferCache:o,keepalive:i})}},A=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(A||{}),B=class{headers;status;statusText;url;ok;type;constructor(t,e=200,n="OK"){this.headers=t.headers||new w,this.status=t.status!==void 0?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}},V=class r extends B{constructor(t={}){super(t)}type=A.ResponseHeader;clone(t={}){return new r({headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}},M=class r extends B{body;constructor(t={}){super(t),this.body=t.body!==void 0?t.body:null}type=A.Response;clone(t={}){return new r({body:t.body!==void 0?t.body:this.body,headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}},D=class extends B{name="HttpErrorResponse";message;error;ok=!1;constructor(t){super(t,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${t.url||"(unknown url)"}`:this.message=`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}},Je=200,nt=204;function ne(r,t){return{body:t,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,transferCache:r.transferCache,keepalive:r.keepalive}}var H=(()=>{class r{handler;constructor(e){this.handler=e}request(e,n,s={}){let i;if(e instanceof C)i=e;else{let a;s.headers instanceof w?a=s.headers:a=new w(s.headers);let y;s.params&&(s.params instanceof k?y=s.params:y=new k({fromObject:s.params})),i=new C(e,n,s.body!==void 0?s.body:null,{headers:a,context:s.context,params:y,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache,keepalive:s.keepalive})}let o=$(i).pipe(me(a=>this.handler.handle(a)));if(e instanceof C||s.observe==="events")return o;let c=o.pipe(pe(a=>a instanceof M));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(X(a=>{if(a.body!==null&&!(a.body instanceof ArrayBuffer))throw new P(2806,!1);return a.body}));case"blob":return c.pipe(X(a=>{if(a.body!==null&&!(a.body instanceof Blob))throw new P(2807,!1);return a.body}));case"text":return c.pipe(X(a=>{if(a.body!==null&&typeof a.body!="string")throw new P(2808,!1);return a.body}));case"json":default:return c.pipe(X(a=>a.body))}case"response":return c;default:throw new P(2809,!1)}}delete(e,n={}){return this.request("DELETE",e,n)}get(e,n={}){return this.request("GET",e,n)}head(e,n={}){return this.request("HEAD",e,n)}jsonp(e,n){return this.request("JSONP",e,{params:new k().append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,n={}){return this.request("OPTIONS",e,n)}patch(e,n,s={}){return this.request("PATCH",e,ne(s,n))}post(e,n,s={}){return this.request("POST",e,ne(s,n))}put(e,n,s={}){return this.request("PUT",e,ne(s,n))}static \u0275fac=function(n){return new(n||r)(v(F))};static \u0275prov=I({token:r,factory:r.\u0275fac})}return r})(),st=/^\)\]\}',?\n/;function Be(r){if(r.url)return r.url;let t=ae.toLocaleLowerCase();return r.headers.get(t)}var Ve=new E(""),K=(()=>{class r{fetchImpl=m(se,{optional:!0})?.fetch??((...e)=>globalThis.fetch(...e));ngZone=m(Ae);destroyRef=m(be);destroyed=!1;constructor(){this.destroyRef.onDestroy(()=>{this.destroyed=!0})}handle(e){return new te(n=>{let s=new AbortController;return this.doRequest(e,s.signal,n).then(oe,i=>n.error(new D({error:i}))),()=>s.abort()})}doRequest(e,n,s){return T(this,null,function*(){let i=this.createRequestInit(e),o;try{let h=this.ngZone.runOutsideAngular(()=>this.fetchImpl(e.urlWithParams,x({signal:n},i)));ot(h),s.next({type:A.Sent}),o=yield h}catch(h){s.error(new D({error:h,status:h.status??0,statusText:h.statusText,url:e.urlWithParams,headers:h.headers}));return}let c=new w(o.headers),a=o.statusText,y=Be(o)??e.urlWithParams,f=o.status,p=null;if(e.reportProgress&&s.next(new V({headers:c,status:f,statusText:a,url:y})),o.body){let h=o.headers.get("content-length"),g=[],l=o.body.getReader(),d=0,b,N,u=typeof Zone<"u"&&Zone.current,R=!1;if(yield this.ngZone.runOutsideAngular(()=>T(this,null,function*(){for(;;){if(this.destroyed){yield l.cancel(),R=!0;break}let{done:O,value:ee}=yield l.read();if(O)break;if(g.push(ee),d+=ee.length,e.reportProgress){N=e.responseType==="text"?(N??"")+(b??=new TextDecoder).decode(ee,{stream:!0}):void 0;let he=()=>s.next({type:A.DownloadProgress,total:h?+h:void 0,loaded:d,partialText:N});u?u.run(he):he()}}})),R){s.complete();return}let z=this.concatChunks(g,d);try{let O=o.headers.get(J)??"";p=this.parseBody(e,z,O)}catch(O){s.error(new D({error:O,headers:new w(o.headers),status:o.status,statusText:o.statusText,url:Be(o)??e.urlWithParams}));return}}f===0&&(f=p?Je:0),f>=200&&f<300?(s.next(new M({body:p,headers:c,status:f,statusText:a,url:y})),s.complete()):s.error(new D({error:p,headers:c,status:f,statusText:a,url:y}))})}parseBody(e,n,s){switch(e.responseType){case"json":let i=new TextDecoder().decode(n).replace(st,"");return i===""?null:JSON.parse(i);case"text":return new TextDecoder().decode(n);case"blob":return new Blob([n],{type:s});case"arraybuffer":return n.buffer}}createRequestInit(e){let n={},s=e.withCredentials?"include":void 0;if(e.headers.forEach((i,o)=>n[i]=o.join(",")),e.headers.has(Q)||(n[Q]=Xe),!e.headers.has(J)){let i=e.detectContentTypeHeader();i!==null&&(n[J]=i)}return{body:e.serializeBody(),method:e.method,headers:n,credentials:s,keepalive:e.keepalive}}concatChunks(e,n){let s=new Uint8Array(n),i=0;for(let o of e)s.set(o,i),i+=o.length;return s}static \u0275fac=function(n){return new(n||r)};static \u0275prov=I({token:r,factory:r.\u0275fac})}return r})(),se=class{};function oe(){}function ot(r){r.then(oe,oe)}function it(r,t){return t(r)}function at(r,t,e){return(n,s)=>Ee(e,()=>t(n,i=>r(i,s)))}var Ge=new E(""),ce=new E(""),qe=new E("",{providedIn:"root",factory:()=>!0});var Z=(()=>{class r extends F{backend;injector;chain=null;pendingTasks=m(Re);contributeToStability=m(qe);constructor(e,n){super(),this.backend=e,this.injector=n}handle(e){if(this.chain===null){let n=Array.from(new Set([...this.injector.get(Ge),...this.injector.get(ce,[])]));this.chain=n.reduceRight((s,i)=>at(s,i,this.injector),it)}if(this.contributeToStability){let n=this.pendingTasks.add();return this.chain(e,s=>this.backend.handle(s)).pipe(ge(n))}else return this.chain(e,n=>this.backend.handle(n))}static \u0275fac=function(n){return new(n||r)(v(U),v(Te))};static \u0275prov=I({token:r,factory:r.\u0275fac})}return r})();var ct=/^\)\]\}',?\n/,lt=RegExp(`^${ae}:`,"m");function dt(r){return"responseURL"in r&&r.responseURL?r.responseURL:lt.test(r.getAllResponseHeaders())?r.getResponseHeader(ae):null}var ie=(()=>{class r{xhrFactory;constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new P(-2800,!1);e.keepalive;let n=this.xhrFactory;return $(null).pipe(ye(()=>new te(i=>{let o=n.build();if(o.open(e.method,e.urlWithParams),e.withCredentials&&(o.withCredentials=!0),e.headers.forEach((l,d)=>o.setRequestHeader(l,d.join(","))),e.headers.has(Q)||o.setRequestHeader(Q,Xe),!e.headers.has(J)){let l=e.detectContentTypeHeader();l!==null&&o.setRequestHeader(J,l)}if(e.responseType){let l=e.responseType.toLowerCase();o.responseType=l!=="json"?l:"text"}let c=e.serializeBody(),a=null,y=()=>{if(a!==null)return a;let l=o.statusText||"OK",d=new w(o.getAllResponseHeaders()),b=dt(o)||e.url;return a=new V({headers:d,status:o.status,statusText:l,url:b}),a},f=()=>{let{headers:l,status:d,statusText:b,url:N}=y(),u=null;d!==nt&&(u=typeof o.response>"u"?o.responseText:o.response),d===0&&(d=u?Je:0);let R=d>=200&&d<300;if(e.responseType==="json"&&typeof u=="string"){let z=u;u=u.replace(ct,"");try{u=u!==""?JSON.parse(u):null}catch(O){u=z,R&&(R=!1,u={error:O,text:u})}}R?(i.next(new M({body:u,headers:l,status:d,statusText:b,url:N||void 0})),i.complete()):i.error(new D({error:u,headers:l,status:d,statusText:b,url:N||void 0}))},p=l=>{let{url:d}=y(),b=new D({error:l,status:o.status||0,statusText:o.statusText||"Unknown Error",url:d||void 0});i.error(b)},_=!1,h=l=>{_||(i.next(y()),_=!0);let d={type:A.DownloadProgress,loaded:l.loaded};l.lengthComputable&&(d.total=l.total),e.responseType==="text"&&o.responseText&&(d.partialText=o.responseText),i.next(d)},g=l=>{let d={type:A.UploadProgress,loaded:l.loaded};l.lengthComputable&&(d.total=l.total),i.next(d)};return o.addEventListener("load",f),o.addEventListener("error",p),o.addEventListener("timeout",p),o.addEventListener("abort",p),e.reportProgress&&(o.addEventListener("progress",h),c!==null&&o.upload&&o.upload.addEventListener("progress",g)),o.send(c),i.next({type:A.Sent}),()=>{o.removeEventListener("error",p),o.removeEventListener("abort",p),o.removeEventListener("load",f),o.removeEventListener("timeout",p),e.reportProgress&&(o.removeEventListener("progress",h),c!==null&&o.upload&&o.upload.removeEventListener("progress",g)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(n){return new(n||r)(v(Me))};static \u0275prov=I({token:r,factory:r.\u0275fac})}return r})(),Ke=new E(""),ht="XSRF-TOKEN",ut=new E("",{providedIn:"root",factory:()=>ht}),ft="X-XSRF-TOKEN",pt=new E("",{providedIn:"root",factory:()=>ft}),G=class{},mt=(()=>{class r{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(e,n){this.doc=e,this.cookieName=n}getToken(){let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Oe(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(n){return new(n||r)(v(we),v(ut))};static \u0275prov=I({token:r,factory:r.\u0275fac})}return r})();function gt(r,t){let e=r.url.toLowerCase();if(!m(Ke)||r.method==="GET"||r.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return t(r);let n=m(G).getToken(),s=m(pt);return n!=null&&!r.headers.has(s)&&(r=r.clone({headers:r.headers.set(s,n)})),t(r)}var le=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(le||{});function yt(r,t){return{\u0275kind:r,\u0275providers:t}}function vt(...r){let t=[H,ie,Z,{provide:F,useExisting:Z},{provide:U,useFactory:()=>m(Ve,{optional:!0})??m(ie)},{provide:Ge,useValue:gt,multi:!0},{provide:Ke,useValue:!0},{provide:G,useClass:mt}];for(let e of r)t.push(...e.\u0275providers);return ve(t)}function Tt(){return yt(le.Fetch,[K,{provide:Ve,useExisting:K},{provide:U,useExisting:K}])}var Et=new E(""),wt="b",bt="h",Rt="s",Pt="st",Dt="u",kt="rt",de=new E(""),At=["GET","HEAD"];function Nt(r,t){let h=m(de),{isCacheActive:e}=h,n=fe(h,["isCacheActive"]),{transferCache:s,method:i}=r;if(!e||s===!1||i==="POST"&&!n.includePostRequests&&!s||i!=="POST"&&!At.includes(i)||!n.includeRequestsWithAuthHeaders&&It(r)||n.filter?.(r)===!1)return t(r);let o=m(De);if(m(Et,{optional:!0}))throw new P(2803,!1);let a=r.url,y=Ot(r,a),f=o.get(y,null),p=n.includeHeaders;if(typeof s=="object"&&s.includeHeaders&&(p=s.includeHeaders),f){let{[wt]:g,[kt]:l,[bt]:d,[Rt]:b,[Pt]:N,[Dt]:u}=f,R=g;switch(l){case"arraybuffer":R=new TextEncoder().encode(g).buffer;break;case"blob":R=new Blob([g]);break}let z=new w(d);return $(new M({body:R,headers:z,status:b,statusText:N,url:u}))}return t(r)}function It(r){return r.headers.has("authorization")||r.headers.has("proxy-authorization")}function We(r){return[...r.keys()].sort().map(t=>`${t}=${r.getAll(t)}`).join("&")}function Ot(r,t){let{params:e,method:n,responseType:s}=r,i=We(e),o=r.serializeBody();o instanceof URLSearchParams?o=We(o):typeof o!="string"&&(o="");let c=[n,s,t,o,i].join("|"),a=Mt(c);return a}function Mt(r){let t=0;for(let e of r)t=Math.imul(31,t)+e.charCodeAt(0)<<0;return t+=2147483648,t.toString()}function wr(r){return[{provide:de,useFactory:()=>(ke("NgHttpTransferCache"),x({isCacheActive:!0},r))},{provide:ce,useValue:Nt,multi:!0},{provide:Ne,multi:!0,useFactory:()=>{let t=m(Ie),e=m(de);return()=>{t.whenStable().then(()=>{e.isCacheActive=!1})}}}]}var Ye=class r extends _e{constructor(e,n,s,i){super();this.http=e;this.platformId=n;this.lockService=s;this.toast=i;this.initializeData()}SHEET_URL=Se.gipfelstuermerSheetUrl;CACHE_KEY="gipfelstuermer_data";CACHE_DURATION=5*60*1e3;config={id:"gipfelstuermer-2025",title:"Gipfelst\xFCrmer Event 2025",active:!1,metricLabel:"H\xF6henmeter",metricUnit:"HM",goalValue:1e5,maxEntryValue:1200,goals:[{target:1e4,emoji:"\u{1F3AD}",reward:"Trainer im Kost\xFCm"},{target:25e3,emoji:"\u{1F355}",reward:"Pizza nach dem Lauf"},{target:5e4,emoji:"\u{1F964}",reward:"Geheimsnack & Getr\xE4nke"},{target:75e3,emoji:"\u{1F370}",reward:"Erdbeertorte & Urkunden"},{target:1e5,emoji:"\u{1F483}",reward:"Schabernack!"}],chartProfile:[{x:0,y:0},{x:1e4,y:1e4},{x:12500,y:8e3},{x:25e3,y:25e3},{x:29e3,y:2e4},{x:5e4,y:5e4},{x:55e3,y:45e3},{x:75e3,y:75e3},{x:82e3,y:69e3},{x:1e5,y:1e5},{x:103e3,y:93e3},{x:11e4,y:7e4}],chartMaxScale:11e4};eventsSubject=new j([]);events$=this.eventsSubject.asObservable().pipe(L(1));entriesSubject=new j([]);rankingsSubject=new j([]);totalSubject=new j(0);chartDataSubject=new j({labels:[],values:[]});dataLoaded=!1;entries$=this.entriesSubject.asObservable().pipe(L(1));rankings$=this.rankingsSubject.asObservable().pipe(L(1));total$=this.totalSubject.asObservable().pipe(L(1));chartData$=this.chartDataSubject.asObservable().pipe(L(1));initializeData(){return T(this,null,function*(){this.loadFromCache()||(yield this.refreshAllData())})}loadFromCache(){if(!re(this.platformId))return!1;try{let e=localStorage.getItem(this.CACHE_KEY);if(e){let{entries:n,events:s,timestamp:i}=JSON.parse(e);if(Date.now()-i<this.CACHE_DURATION)return this.updateState(n),this.eventsSubject.next(s),this.dataLoaded=!0,!0;localStorage.removeItem(this.CACHE_KEY)}}catch(e){console.error("Error reading from cache:",e)}return!1}saveToCache(e,n){if(re(this.platformId))try{let s={entries:e,events:n,timestamp:Date.now()};localStorage.setItem(this.CACHE_KEY,JSON.stringify(s))}catch(s){console.error("Error saving to cache:",s)}}refreshAllData(){return T(this,null,function*(){try{let e=yield this.fetchAllData(),n=this.processEntries(e.main),s=e.events;this.updateState(n),this.eventsSubject.next(s),this.saveToCache(n,s),this.dataLoaded=!0}catch(e){console.error("Error refreshing all data:",e),this.toast.show("Fehler beim Laden der Daten!",4e3)}})}loadData(){return T(this,null,function*(){this.dataLoaded||(yield this.refreshAllData())})}submitData(e,n){return T(this,null,function*(){if(!this.config.active){this.toast.show("Die Challenge ist beendet. Keine Eintr\xE4ge mehr m\xF6glich. \u{1F512}");return}if(!(yield this.lockService.requestUnlock()))return;let i={name:e,value:n,date:new Date().toISOString()};try{this.updateLocalState(i,"add"),yield S(this.http.get(`${this.SHEET_URL}?action=add&name=${encodeURIComponent(e)}&hohenmeter=${n}`)),this.toast.show("Eintrag erfolgreich hinzugef\xFCgt!")}catch(o){throw console.error("Error submitting data:",o),yield this.refreshAllData(),this.toast.show("Fehler beim Hinzuf\xFCgen des Eintrags!",4e3),o}})}deleteData(e){return T(this,null,function*(){if(yield this.lockService.requestUnlock())try{this.updateLocalState(e,"delete"),yield S(this.http.get(`${this.SHEET_URL}?action=delete&name=${encodeURIComponent(e.name)}&hohenmeter=${e.value}`)),this.toast.show("Eintrag gel\xF6scht.")}catch(s){throw console.error("Error deleting data:",s),yield this.refreshAllData(),this.toast.show("Fehler beim L\xF6schen des Eintrags!",4e3),s}})}addParticipant(e,n){return T(this,null,function*(){try{if((yield S(this.http.get(`${this.SHEET_URL}?action=addParticipant&eventName=${encodeURIComponent(e)}&participantName=${encodeURIComponent(n)}`)))?.status==="participant_added"){let i=[...this.eventsSubject.value],o=i.find(c=>c.name===e);return o&&(o.participants||(o.participants=[]),o.participants.push(n),this.eventsSubject.next(i),this.saveToCache(this.entriesSubject.value,i)),this.toast.show("Teilnehmer hinzugef\xFCgt!"),!0}return this.toast.show("Teilnehmer konnte nicht hinzugef\xFCgt werden.",4e3),!1}catch(s){return console.error("Error adding participant:",s),this.toast.show("Fehler beim Hinzuf\xFCgen des Teilnehmers!",4e3),!1}})}updateLocalState(e,n){let s=[...this.entriesSubject.value],i=!1;if(n==="add")s.unshift(e),i=!0;else{let o=s.findIndex(c=>c.name===e.name&&c.value===e.value);o!==-1&&(s.splice(o,1),i=!0)}i&&(this.updateState(s),this.saveToCache(s,this.eventsSubject.value))}updateState(e){this.entriesSubject.next(e),this.rankingsSubject.next(this.calculateRankings(e)),this.totalSubject.next(this.calculateTotal(e)),this.chartDataSubject.next(this.calculateChartData(e)),this.dataLoaded=e.length>0}processEntries(e){return e.map(n=>{let s=n;return{name:s[0],value:parseInt(s[1]),date:s[2]}})}calculateTotal(e){return e.reduce((n,s)=>n+s.value,0)}calculateRankings(e){let n=e.reduce((s,i)=>(s[i.name]=(s[i.name]??0)+i.value,s),{});return Object.entries(n).map(([s,i])=>({name:s,value:i})).sort((s,i)=>i.value-s.value)}calculateChartData(e){let n=[...e].sort((s,i)=>new Date(s.date).getTime()-new Date(i.date).getTime()).slice(-100);return{labels:n.map(s=>new Date(s.date).toLocaleDateString()),values:n.map(s=>s.value)}}fetchAllData(){return T(this,null,function*(){try{let e=yield S(this.http.get(`${this.SHEET_URL}?action=getAllParticipants`)),n=yield S(this.http.get(`${this.SHEET_URL}?action=get`)),s=new Date;s.setHours(0,0,0,0);let i=e.filter(o=>{let c=new Date(o.date);return c.setHours(0,0,0,0),c>=s}).map(o=>ue(x({},o),{daysLeft:this.calculateDaysLeft(o.date),participants:o.participants??[]})).sort((o,c)=>new Date(o.date).getTime()-new Date(c.date).getTime());return{main:n?.main??[],ranking:n?.ranking??[],events:i}}catch(e){return console.error("Error fetching data:",e),{main:[],ranking:[],events:[]}}})}isDataLoaded(){return this.entriesSubject.value.length>0}calculateDaysLeft(e){let n=new Date(e),s=new Date;s.setHours(0,0,0,0),n.setHours(0,0,0,0);let i=n.getTime()-s.getTime();return Math.round(i/(1e3*60*60*24))}static \u0275fac=function(n){return new(n||r)(v(H),v(Pe),v(xe),v(je))};static \u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"})};export{vt as a,Tt as b,wr as c,Ye as d};
